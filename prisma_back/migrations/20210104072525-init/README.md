# Migration `20210104072525-init`

This migration has been generated by sesia at 1/4/2021, 4:25:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `craneDataRecord` DROP FOREIGN KEY `craneDataRecord_ibfk_1`

ALTER TABLE `craneDataRecord` DROP FOREIGN KEY `craneDataRecord_ibfk_2`

ALTER TABLE `Post` MODIFY `postCategory` ENUM('JOB', 'REPAIR', 'ETC') NOT NULL

CREATE TABLE `craneData` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `createdAt` DATETIME(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
    `riggingIndex` INT NOT NULL,
    `craneName` VARCHAR(191),
    `craneCode` VARCHAR(191),
    `craneModeName` VARCHAR(191),
    `excelSheetName` VARCHAR(191),
    `riggingDataId` INT NOT NULL,
    `userId` INT,

    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

DROP TABLE `craneDataRecord`

ALTER TABLE `craneData` ADD FOREIGN KEY (`riggingDataId`) REFERENCES `RiggingData`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `craneData` ADD FOREIGN KEY (`userId`) REFERENCES `User`(`id`) ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210104031500-init..20210104072525-init
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 model User {
   id              Int               @id @default(autoincrement())
@@ -18,9 +18,9 @@
   avatar          String            @default(value: "")
   posts           Post[]
   comments        Comment[]
   likes           Like[]
-  riggingRecord   craneDataRecord[]
+  riggingRecords  craneData[]
   overWorks       OverWork[]
   following       User[]            @relation("FollowRelation", references: [id])
   followers       User[]            @relation("FollowRelation", references: [id])
 }
@@ -59,9 +59,9 @@
   userId    Int?
   postId    Int
 }
-model craneDataRecord {
+model craneData {
   id             Int         @id @default(autoincrement())
   createdAt      DateTime    @default(now())
   riggingIndex   Int
   craneName      String?
@@ -113,26 +113,23 @@
   workBuilding             WorkBuilding      @relation(fields: [workBuildingId], references: [id])
   workBuildingId           Int
   block                    Block             @relation(fields: [blockId], references: [id])
   blockId                  Int
-  craneDataRecord          craneDataRecord[]
 }
 model EdgeDistance {
   id                      Int           @id @default(autoincrement())
   mainToBlock             Float
   mainToBuilding          Float
   flyFixLuffingToBlock    Float
   flyFixLuffingToBuilding Float
-  RiggingData             RiggingData[]
 }
 model WorkBuilding {
   id          Int           @id @default(autoincrement())
   horizontal  Float
   vertical    Float
   height      Float
-  RiggingData RiggingData[]
 }
 model Block {
   id          Int           @id @default(autoincrement())
@@ -140,9 +137,8 @@
   horizontal1 Float
   height1     Float
   vertical2   Float
   height2     Float
-  RiggingData RiggingData[]
 }
 model OverWork {
   id               Int              @id @default(autoincrement())
```


